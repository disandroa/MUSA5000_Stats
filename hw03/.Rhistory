setwd("~/Documents/GitHub/MUSA5000_Stats/hw03")
knitr::opts_chunk$set(echo = T, eval = T, warning = F, message = F)
# get rid of scientific notation
options(scipen = 999)
# set working directory
# setwd("~/Documents/GitHub/MUSA5000_Stats/hw03")
# load packages
library(tidyverse)
library(aod)
install.packages("aod")
knitr::opts_chunk$set(echo = T, eval = T, warning = F, message = F)
# get rid of scientific notation
options(scipen = 999)
# set working directory
# setwd("~/Documents/GitHub/MUSA5000_Stats/hw03")
# load packages
library(tidyverse)
library(aod)
library(ggplot2)
library(rms)
install.packages("rms")
knitr::opts_chunk$set(echo = T, eval = T, warning = F, message = F)
# get rid of scientific notation
options(scipen = 999)
# set working directory
# setwd("~/Documents/GitHub/MUSA5000_Stats/hw03")
# load packages
library(tidyverse)
library(aod)
library(ggplot2)
library(rms)
library(gmodels)
library(nnet)
library(DAAG)
library(ROCR)
library(xtable)
library(kableExtra)
library(ggcorrplot)
data <- read.csv("data/Logistic Regression Data.csv")
mydata <- read.csv("data/Logistic Regression Data.csv")
View(data)
DRINKING_D.tab <- table(mydata$DRINKING_D)
prop.table(DRINKING_D.tab)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M, mydata$OVERTURNED,
mydata$CELL_PHONE, mydata$SPEEDING, mydata$AGGRESSIVE,
mydata$DRIVER1617,mydata$DRIVER65PLUS,
prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M, mydata$OVERTURNED,
mydata$CELL_PHONE, mydata$SPEEDING, mydata$AGGRESSIVE,
mydata$DRIVER1617,mydata$DRIVER65PLUS,
prop.r=FALSE,prop.t=FALSE)
crossT_fatal <- CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
View(crossT_fatal)
fatal_CrossT <- CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
overturned_CrossT <- CrossTable(mydata$DRINKING_D, mydata$OVERTURNED,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
cell_phone_CrossT <- CrossTable(mydata$DRINKING_D, mydata$CELL_PHONE,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
speeding_CrossT <- CrossTable(mydata$DRINKING_D, mydata$SPEEDING,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
aggressive_CrossT <- CrossTable(mydata$DRINKING_D, mydata$AGGRESSIVE,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
driver1617_CrossT <- CrossTable(mydata$DRINKING_D, mydata$DRIVER1617,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
driver65plus_CrossT <- CrossTable(mydata$DRINKING_D, mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M + mydata$OVERTURNED,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$FATAL_OR_M + mydata$OVERTURNED + mydata$CELL_PHONE + mydata$SPEEDING +
mydata$AGGRESSIVE + mydata$DRIVER1617 + mydata$DRIVER65PLUS,
mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
View(cell_phone_CrossT)
class(cell_phone_CrossT)
CrossTable(mydata$FATAL_OR_M + mydata$OVERTURNED + mydata$CELL_PHONE + mydata$SPEEDING +
mydata$AGGRESSIVE + mydata$DRIVER1617 + mydata$DRIVER65PLUS,
mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
dnn = c("Wool", "Tension"))
CrossTable(mydata$FATAL_OR_M + mydata$OVERTURNED + mydata$CELL_PHONE + mydata$SPEEDING +mydata$AGGRESSIVE + mydata$DRIVER1617 + mydata$DRIVER65PLUS,
mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
dnn = c("Wool", "Tension"))
CrossTable(mydata$FATAL_OR_M + mydata$OVERTURNED + mydata$CELL_PHONE + mydata$SPEEDING +mydata$AGGRESSIVE + mydata$DRIVER1617 + mydata$DRIVER65PLUS,mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
dnn = c("Wool", "Tension"))
View(fatal_CrossT)
fatal_CrossT
CrossTable(mydata$FATAL_OR_M + mydata$OVERTURNED + mydata$CELL_PHONE + mydata$SPEEDING +mydata$AGGRESSIVE + mydata$DRIVER1617 + mydata$DRIVER65PLUS,mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
dnn = c("Var", "Drinking"))
CrossTable(mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE,
dnn = c("Var", "Drinking"))
CrossTable(mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
fatal_CrossT <- CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
overturned_CrossT <- CrossTable(mydata$DRINKING_D, mydata$OVERTURNED,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
cell_phone_CrossT <- CrossTable(mydata$DRINKING_D, mydata$CELL_PHONE,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
speeding_CrossT <- CrossTable(mydata$DRINKING_D, mydata$SPEEDING,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
aggressive_CrossT <- CrossTable(mydata$DRINKING_D, mydata$AGGRESSIVE,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
driver1617_CrossT <- CrossTable(mydata$DRINKING_D, mydata$DRIVER1617,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
driver65plus_CrossT <- CrossTable(mydata$DRINKING_D, mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
fatal_CrossT <- CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
overturned_CrossT <- CrossTable(mydata$OVERTURNED, mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
cell_phone_CrossT <- CrossTable(mydata$CELL_PHONE, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
speeding_CrossT <- CrossTable(mydata$SPEEDING, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
aggressive_CrossT <- CrossTable(mydata$AGGRESSIVE, mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
driver1617_CrossT <- CrossTable(mydata$DRIVER1617, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
driver65plus_CrossT <- CrossTable(mydata$DRIVER65PLUS, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
as.data.frame(cell_phone_CrossT)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS, max_width=6,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS, max_width=6,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE, format = "SPSS")
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS, max_width=6,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M==1+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M==1+mydata$OVERTURNED==1+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M==1+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$DRINKING_D, mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$FATAL_OR_M+mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$FATAL_OR_M,mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617,
mydata$DRIVER65PLUS,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617,
mydata$DRIVER65PLUS+mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
CrossTable(mydata$OVERTURNED+mydata$CELL_PHONE+mydata$SPEEDING+mydata$AGGRESSIVE+mydata$DRIVER1617+
mydata$DRIVER65PLUS,mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE,chisq=FALSE,prop.t=FALSE)
fatal_CrossT[2:]
fatal_CrossT[,2]
fatal_crossT[,2][1]
fatal_CrossT[, 2][1]
View(fatal_CrossT)
fatal_CrossT[["t"]]
fatal_CrossT[["t"]][2]
fatal_CrossT[["prop.tbl"]]
fatal_CrossT[["t"]]
fatal_CrossT[["prop.col"]]
fatal_CrossT
table(fatal_CrossT)
CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
fatal_CrossT <- CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
View(fatal_CrossT)
fatal_CrossT <- CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=TRUE,
cell.layout=TRUE)
fatal_CrossT <- CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
View(fatal_CrossT)
fatal_CrossT
summary(fatal_CrossT)
CrossTable(mydata$FATAL_OR_M==1, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
CrossTable(mydata$FATAL_OR_M %>% filter(FATAL_OR_M==1), mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
CrossTable(mydata$FATAL_OR_M+mydata$CELL_PHONE, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
View(mydata)
mydata[2:5]
mydata[3:10]
CrossTable(mydata[3:10], mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
CrossTable(mydata$DRINKING_D,mydata[3:10], prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
CrossTable(mydata$DRINKING_D,mydata, prop.r=FALSE,prop.chisq=FALSE, chisq=FALSE,prop.t=FALSE,
cell.layout=TRUE)
View(fatal_CrossT)
fatal_CrossT[["t"]][2]
fatal_CrossT[["t"]][2:,]
fatal_CrossT[["t"]][2:]
fatal_CrossT[["t"]][2][:,]
fatal_CrossT[["t"]]
fatal_CrossT[["t"]][2]
fatal_CrossT[["prop.row"]][2]
fatal_CrossT[["prop.row"]][2]
fatal_CrossT[["prop.row"]][3]
fatal_CrossT[["prop.row"]][4]
fatal_CrossT[["prop.col"]][2]
fatal_CrossT[["t"]][,2]
fatal_CrossT[["t"]][,2][2]
fatal_CrossT[["t"]][,2][1]
fatal_CrossT[["t"]]
fatal_CrossT[["prop.tbl"]]
fatal_CrossT[["t"]]
fatal_CrossT[["t"]][,2][1] + fatal_CrossT[["t"]][,2][2]
fatal_CrossT[["t"]][,2][2]
fatal_CrossT[["t"]][,2][1]
fatal_CrossT[["t"]][,3][2]
fatal_CrossT[["t"]][,1][2]
fatal_CrossT[["t"]][,2][2]+fatal_CrossT[["t"]][,1][2]
crosstable1.df <- data.frame(var_name <- c("FATAL_OR_M: Crash resulted in fatality or major injury",
"OVERTURNED: Crash involved an overturned vehicle",
"CELL_PHONE: Driver was using cell phone",
"SPEEDING: Crash involved speeding car",
"AGGRESSIVE: Crash involved aggressive driving",
"DRIVER1617: Crash involved at least one driver who was 16 or 17 years old",
"DRIVER65PLUS: Crash involved at least one driver who was at least 65 years old"
),
no_drinkN <- c(fatal_CrossT[["t"]][,1][2],
overturned_CrossT[["t"]][,1][2], cell_phone_CrossT[["t"]][,1][2],speeding_CrossT[["t"]][,1][2],
aggressive_CrossT[["t"]][,1][2], driver1617_CrossT[["t"]][,1][2],driver65plus_CrossT[["t"]][,1][2]
),
no_drinkProp <- c(fatal_CrossT[["prop.col"]][,1][2],
overturned_CrossT[["prop.col"]][,1][2], cell_phone_CrossT[["prop.col"]][,1][2],
speeding_CrossT[["prop.col"]][,1][2],
aggressive_CrossT[["prop.col"]][,1][2],
driver1617_CrossT[["prop.col"]][,1][2],driver65plus_CrossT[["prop.col"]][,1][2]),
y_drinkN <- c(fatal_CrossT[["t"]][,2][2],
overturned_CrossT[["t"]][,2][2], cell_phone_CrossT[["t"]][,2][2],speeding_CrossT[["t"]][,2][2],
aggressive_CrossT[["t"]][,2][2], driver1617_CrossT[["t"]][,2][2],driver65plus_CrossT[["t"]][,2][2]
),
y_drinkProp <- c(fatal_CrossT[["prop.col"]][,2][2],
overturned_CrossT[["prop.col"]][,2][2], cell_phone_CrossT[["prop.col"]][,2][2],
speeding_CrossT[["prop.col"]][,2][2],
aggressive_CrossT[["prop.col"]][,2][2]),
total <- c(fatal_CrossT[["t"]][,2][2]+fatal_CrossT[["t"]][,1][2],
overturned_CrossT[["t"]][,2][2]+overturned_CrossT[["t"]][,1][2],
cell_phone_CrossT[["t"]][,2][2]+cell_phone_CrossT[["t"]][,1][2],
speeding_CrossT[["t"]][,2][2]+speeding_CrossT[["t"]][,1][2],
aggressive_CrossT[["t"]][,2][2]+aggressive_CrossT[["t"]][,1][2],
driver1617_CrossT[["t"]][,2][2]+driver1617_CrossT[["t"]][,1][2],
driver65plus_CrossT[["t"]][,2][2]+driver65plus_CrossT[["t"]][,1][2]))
crosstable1.df <- data.frame(var_name <- c("FATAL_OR_M: Crash resulted in fatality or major injury",
"OVERTURNED: Crash involved an overturned vehicle",
"CELL_PHONE: Driver was using cell phone",
"SPEEDING: Crash involved speeding car",
"AGGRESSIVE: Crash involved aggressive driving",
"DRIVER1617: Crash involved at least one driver who was 16 or 17 years old",
"DRIVER65PLUS: Crash involved at least one driver who was at least 65 years old"
),
no_drinkN <- c(fatal_CrossT[["t"]][,1][2],
overturned_CrossT[["t"]][,1][2], cell_phone_CrossT[["t"]][,1][2],speeding_CrossT[["t"]][,1][2],
aggressive_CrossT[["t"]][,1][2], driver1617_CrossT[["t"]][,1][2],driver65plus_CrossT[["t"]][,1][2]
),
no_drinkProp <- c(fatal_CrossT[["prop.col"]][,1][2],
overturned_CrossT[["prop.col"]][,1][2], cell_phone_CrossT[["prop.col"]][,1][2],
speeding_CrossT[["prop.col"]][,1][2],
aggressive_CrossT[["prop.col"]][,1][2],
driver1617_CrossT[["prop.col"]][,1][2],driver65plus_CrossT[["prop.col"]][,1][2]),
y_drinkN <- c(fatal_CrossT[["t"]][,2][2],
overturned_CrossT[["t"]][,2][2], cell_phone_CrossT[["t"]][,2][2],speeding_CrossT[["t"]][,2][2],
aggressive_CrossT[["t"]][,2][2], driver1617_CrossT[["t"]][,2][2],driver65plus_CrossT[["t"]][,2][2]
),
y_drinkProp <- c(fatal_CrossT[["prop.col"]][,2][2],
overturned_CrossT[["prop.col"]][,2][2], cell_phone_CrossT[["prop.col"]][,2][2],
speeding_CrossT[["prop.col"]][,2][2],
aggressive_CrossT[["prop.col"]][,2][2],
driver1617_CrossT[["prop.col"]][,2][2],driver65plus_CrossT[["prop.col"]][,2][2]),
total <- c(fatal_CrossT[["t"]][,2][2]+fatal_CrossT[["t"]][,1][2],
overturned_CrossT[["t"]][,2][2]+overturned_CrossT[["t"]][,1][2],
cell_phone_CrossT[["t"]][,2][2]+cell_phone_CrossT[["t"]][,1][2],
speeding_CrossT[["t"]][,2][2]+speeding_CrossT[["t"]][,1][2],
aggressive_CrossT[["t"]][,2][2]+aggressive_CrossT[["t"]][,1][2],
driver1617_CrossT[["t"]][,2][2]+driver1617_CrossT[["t"]][,1][2],
driver65plus_CrossT[["t"]][,2][2]+driver65plus_CrossT[["t"]][,1][2]))
View(crosstable1.df)
kbl(crosstable1.df)
crosstable1.df <- data.frame(var_name <- c("FATAL_OR_M: Crash resulted in fatality or major injury",
"OVERTURNED: Crash involved an overturned vehicle",
"CELL_PHONE: Driver was using cell phone",
"SPEEDING: Crash involved speeding car",
"AGGRESSIVE: Crash involved aggressive driving",
"DRIVER1617: Crash involved at least one driver who was 16 or 17 years old",
"DRIVER65PLUS: Crash involved at least one driver who was at least 65 years old"
),
no_drinkN <- c(fatal_CrossT[["t"]][,1][2],
overturned_CrossT[["t"]][,1][2], cell_phone_CrossT[["t"]][,1][2],speeding_CrossT[["t"]][,1][2],
aggressive_CrossT[["t"]][,1][2], driver1617_CrossT[["t"]][,1][2],driver65plus_CrossT[["t"]][,1][2]
),
no_drinkProp <- c(fatal_CrossT[["prop.col"]][,1][2],
overturned_CrossT[["prop.col"]][,1][2], cell_phone_CrossT[["prop.col"]][,1][2],
speeding_CrossT[["prop.col"]][,1][2],
aggressive_CrossT[["prop.col"]][,1][2],
driver1617_CrossT[["prop.col"]][,1][2],driver65plus_CrossT[["prop.col"]][,1][2]),
y_drinkN <- c(fatal_CrossT[["t"]][,2][2],
overturned_CrossT[["t"]][,2][2], cell_phone_CrossT[["t"]][,2][2],speeding_CrossT[["t"]][,2][2],
aggressive_CrossT[["t"]][,2][2], driver1617_CrossT[["t"]][,2][2],driver65plus_CrossT[["t"]][,2][2]
),
y_drinkProp <- c(fatal_CrossT[["prop.col"]][,2][2],
overturned_CrossT[["prop.col"]][,2][2], cell_phone_CrossT[["prop.col"]][,2][2],
speeding_CrossT[["prop.col"]][,2][2],
aggressive_CrossT[["prop.col"]][,2][2],
driver1617_CrossT[["prop.col"]][,2][2],driver65plus_CrossT[["prop.col"]][,2][2]),
total <- c(fatal_CrossT[["t"]][,2][2]+fatal_CrossT[["t"]][,1][2],
overturned_CrossT[["t"]][,2][2]+overturned_CrossT[["t"]][,1][2],
cell_phone_CrossT[["t"]][,2][2]+cell_phone_CrossT[["t"]][,1][2],
speeding_CrossT[["t"]][,2][2]+speeding_CrossT[["t"]][,1][2],
aggressive_CrossT[["t"]][,2][2]+aggressive_CrossT[["t"]][,1][2],
driver1617_CrossT[["t"]][,2][2]+driver1617_CrossT[["t"]][,1][2],
driver65plus_CrossT[["t"]][,2][2]+driver65plus_CrossT[["t"]][,1][2]))
kbl(crosstable1.df) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
crosstable1.df <- data.frame(var_name = c("FATAL_OR_M: Crash resulted in fatality or major injury",
"OVERTURNED: Crash involved an overturned vehicle",
"CELL_PHONE: Driver was using cell phone",
"SPEEDING: Crash involved speeding car",
"AGGRESSIVE: Crash involved aggressive driving",
"DRIVER1617: Crash involved at least one driver who was 16 or 17 years old",
"DRIVER65PLUS: Crash involved at least one driver who was at least 65 years old"
),
no_drinkN = c(fatal_CrossT[["t"]][,1][2],
overturned_CrossT[["t"]][,1][2], cell_phone_CrossT[["t"]][,1][2],speeding_CrossT[["t"]][,1][2],
aggressive_CrossT[["t"]][,1][2], driver1617_CrossT[["t"]][,1][2],driver65plus_CrossT[["t"]][,1][2]
),
no_drinkProp = c(fatal_CrossT[["prop.col"]][,1][2],
overturned_CrossT[["prop.col"]][,1][2], cell_phone_CrossT[["prop.col"]][,1][2],
speeding_CrossT[["prop.col"]][,1][2],
aggressive_CrossT[["prop.col"]][,1][2],
driver1617_CrossT[["prop.col"]][,1][2],driver65plus_CrossT[["prop.col"]][,1][2]),
y_drinkN = c(fatal_CrossT[["t"]][,2][2],
overturned_CrossT[["t"]][,2][2], cell_phone_CrossT[["t"]][,2][2],speeding_CrossT[["t"]][,2][2],
aggressive_CrossT[["t"]][,2][2], driver1617_CrossT[["t"]][,2][2],driver65plus_CrossT[["t"]][,2][2]
),
y_drinkProp = c(fatal_CrossT[["prop.col"]][,2][2],
overturned_CrossT[["prop.col"]][,2][2], cell_phone_CrossT[["prop.col"]][,2][2],
speeding_CrossT[["prop.col"]][,2][2],
aggressive_CrossT[["prop.col"]][,2][2],
driver1617_CrossT[["prop.col"]][,2][2],driver65plus_CrossT[["prop.col"]][,2][2]),
total = c(fatal_CrossT[["t"]][,2][2]+fatal_CrossT[["t"]][,1][2],
overturned_CrossT[["t"]][,2][2]+overturned_CrossT[["t"]][,1][2],
cell_phone_CrossT[["t"]][,2][2]+cell_phone_CrossT[["t"]][,1][2],
speeding_CrossT[["t"]][,2][2]+speeding_CrossT[["t"]][,1][2],
aggressive_CrossT[["t"]][,2][2]+aggressive_CrossT[["t"]][,1][2],
driver1617_CrossT[["t"]][,2][2]+driver1617_CrossT[["t"]][,1][2],
driver65plus_CrossT[["t"]][,2][2]+driver65plus_CrossT[["t"]][,1][2]))
kbl(crosstable1.df) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
chisqfatal_CrossT <- CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqoverturned_CrossT <- CrossTable(mydata$OVERTURNED, mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqcell_phone_CrossT <- CrossTable(mydata$CELL_PHONE, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqspeeding_CrossT <- CrossTable(mydata$SPEEDING, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqaggressive_CrossT <- CrossTable(mydata$AGGRESSIVE, mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqdriver1617_CrossT <- CrossTable(mydata$DRIVER1617, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqdriver65plus_CrossT <- CrossTable(mydata$DRIVER65PLUS, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=TRUE, chisq=FALSE,prop.t=FALSE)
View(chisqfatal_CrossT)
chisqfatal_CrossT[["chisq"]]
chisqfatal_CrossT[["chisq"]][["p.value"]]
crosstable1.df$chisq.pval <- c(chisqfatal_CrossT[["chisq"]][["p.value"]],
chisqoverturned_CrossT[["chisq"]][["p.value"]],
chisqcell_phone_CrossT[["chisq"]][["p.value"]],
chisqspeeding_CrossT[["chisq"]][["p.value"]],
chisqaggressive_CrossT[["chisq"]][["p.value"]],
chisqdriver1617_CrossT[["chisq"]][["p.value"]],
chisqdriver65plus_CrossT[["chisq"]][["p.value"]])
crosstable1.df$chisq.pval <- c(chisqfatal_CrossT[["chisq"]][["p.value"]],
chisqoverturned_CrossT[["chisq"]][["p.value"]],
chisqcell_phone_CrossT[["chisq"]][["p.value"]],
chisqspeeding_CrossT[["chisq"]][["p.value"]],
chisqaggressive_CrossT[["chisq"]][["p.value"]],
chisqdriver1617_CrossT[["chisq"]][["p.value"]],
chisqdriver65plus_CrossT[["chisq"]][["p.value"]])
crosstable1.df$chisq.pval = c(chisqfatal_CrossT[["chisq"]][["p.value"]],
chisqoverturned_CrossT[["chisq"]][["p.value"]],
chisqcell_phone_CrossT[["chisq"]][["p.value"]],
chisqspeeding_CrossT[["chisq"]][["p.value"]],
chisqaggressive_CrossT[["chisq"]][["p.value"]],
chisqdriver1617_CrossT[["chisq"]][["p.value"]],
chisqdriver65plus_CrossT[["chisq"]][["p.value"]])
crosstable1.df %>% mutate(
chisq.pval = c(chisqfatal_CrossT[["chisq"]][["p.value"]],
chisqoverturned_CrossT[["chisq"]][["p.value"]],
chisqcell_phone_CrossT[["chisq"]][["p.value"]],
chisqspeeding_CrossT[["chisq"]][["p.value"]],
chisqaggressive_CrossT[["chisq"]][["p.value"]],
chisqdriver1617_CrossT[["chisq"]][["p.value"]],
chisqdriver65plus_CrossT[["chisq"]][["p.value"]]))
crosstable1.df %>% mutate(
chisq.pval = c(chisqfatal_CrossT[["chisq"]][["p.value"]],
chisqoverturned_CrossT[["chisq"]][["p.value"]],
chisqcell_phone_CrossT[["chisq"]][["p.value"]],
chisqspeeding_CrossT[["chisq"]][["p.value"]],
chisqaggressive_CrossT[["chisq"]][["p.value"]],
chisqdriver1617_CrossT[["chisq"]][["p.value"]],
chisqdriver65plus_CrossT[["chisq"]][["p.value"]]))
View(chisqdriver65plus_CrossT)
chisqfatal_CrossT <- CrossTable(mydata$FATAL_OR_M, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqoverturned_CrossT <- CrossTable(mydata$OVERTURNED, mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqcell_phone_CrossT <- CrossTable(mydata$CELL_PHONE, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqspeeding_CrossT <- CrossTable(mydata$SPEEDING, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqaggressive_CrossT <- CrossTable(mydata$AGGRESSIVE, mydata$DRINKING_D,prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqdriver1617_CrossT <- CrossTable(mydata$DRIVER1617, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=FALSE, chisq=TRUE,prop.t=FALSE)
chisqdriver65plus_CrossT <- CrossTable(mydata$DRIVER65PLUS, mydata$DRINKING_D, prop.r=FALSE,prop.chisq=TRUE, chisq=TRUE,prop.t=FALSE)
crosstable1.df %>% mutate(
chisq.pval = c(chisqfatal_CrossT[["chisq"]][["p.value"]],
chisqoverturned_CrossT[["chisq"]][["p.value"]],
chisqcell_phone_CrossT[["chisq"]][["p.value"]],
chisqspeeding_CrossT[["chisq"]][["p.value"]],
chisqaggressive_CrossT[["chisq"]][["p.value"]],
chisqdriver1617_CrossT[["chisq"]][["p.value"]],
chisqdriver65plus_CrossT[["chisq"]][["p.value"]]))
kbl(crosstable1.df) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
crosstable1.df %>% mutate(
chisq.pval = c(chisqfatal_CrossT[["chisq"]][["p.value"]],
chisqoverturned_CrossT[["chisq"]][["p.value"]],
chisqcell_phone_CrossT[["chisq"]][["p.value"]],
chisqspeeding_CrossT[["chisq"]][["p.value"]],
chisqaggressive_CrossT[["chisq"]][["p.value"]],
chisqdriver1617_CrossT[["chisq"]][["p.value"]],
chisqdriver65plus_CrossT[["chisq"]][["p.value"]]))
kbl(crosstable1.df) %>%
kable_styling(bootstrap_options = "striped", full_width = F)
tapply(mydata$PCTBACHMOR,
mydata$DRINKING_D, mean)
tapply(mydata$PCTBACHMOR,
mydata$DRINKING_D, mean)
tapply(mydata$PCTBACHMOR, mydata$DRINKING_D, sd)
tapply(mydata$PCTBACHMOR,
mydata$DRINKING_D, mean)
tapply(mydata$PCTBACHMOR, mydata$DRINKING_D, sd)
tapply(mydata$MEDHHINC,
mydata$DRINKING_D, mean)
tapply(mydata$MEDHHINC, mydata$DRINKING_D, sd)
t.test(mydata$PCTBACHMOR~mydata$DRINKING_D)
t.test(mydata$MEDHHINC~mydata$DRINKING_D)
cormat <- data %>%
dplyr::select(FATAL_OR_M:DRIVER65PLUS,PCTBACHMOR,MEDHHINC) %>%
cor()
cormat <- mydata %>%
dplyr::select(FATAL_OR_M:DRIVER65PLUS,PCTBACHMOR,MEDHHINC) %>%
cor()
cor_plot <- ggcorrplot(cormat,
method = "circle",
type = "lower",
lab = TRUE,
lab_size = 3,
colors = c("#451077FF", "white", "#F1605DFF"),
outline.color = "white",
title = "Correlation Matrix of Predictors",
legend.title = "Correlation") +
theme_minimal() +
labs(x = "",
y = "") +
theme(axis.text.x = element_text(angle = 20))
cor_plot
mylogit <- glm(DRINKING_D ~ FATAL_OR_M+OVERTURNED+CELL_PHONE+SPEEDING+AGGRESSIVE+DRIVER1617+
DRIVER65PLUS+PCTBACHMOR+MEDHHINC, data = mydata, family = "binomial")
summary(mylogit)
confint.default(mylogit)  #95% confidence intervals
exp(cbind(OR = coef(mylogit), confint(mylogit)))
